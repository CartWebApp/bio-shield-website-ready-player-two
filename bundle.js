class e extends Error{constructor(e,r){super(e),this.name="DevalueError",this.path=r.join("")}}function r(e){return Object(e)!==e}const t=Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function n(e){switch(e){case'"':return'\\"';case"<":return"\\u003C";case"\\":return"\\\\";case"\n":return"\\n";case"\r":return"\\r";case"\t":return"\\t";case"\b":return"\\b";case"\f":return"\\f";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:return e<" "?`\\u${e.charCodeAt(0).toString(16).padStart(4,"0")}`:""}}function a(e){let r="",t=0;const a=e.length;for(let o=0;o<a;o+=1){const a=n(e[o]);a&&(r+=e.slice(t,o)+a,t=o+1)}return`"${0===t?e:r+e.slice(t)}"`}const o=/^[a-zA-Z_$][a-zA-Z_$0-9]*$/;function c(e){return o.test(e)?"."+e:"["+JSON.stringify(e)+"]"}function s(e){const r=new DataView(e);let t="";for(let n=0;n<e.byteLength;n++)t+=String.fromCharCode(r.getUint8(n));return function(e){let r="";for(let t=0;t<e.length;t+=3){const n=[void 0,void 0,void 0,void 0];n[0]=e.charCodeAt(t)>>2,n[1]=(3&e.charCodeAt(t))<<4,e.length>t+1&&(n[1]|=e.charCodeAt(t+1)>>4,n[2]=(15&e.charCodeAt(t+1))<<2),e.length>t+2&&(n[2]|=e.charCodeAt(t+2)>>6,n[3]=63&e.charCodeAt(t+2));for(let e=0;e<n.length;e++)void 0===n[e]?r+="=":r+=f[n[e]]}return r}(t)}function i(e){const r=function(e){e.length%4==0&&(e=e.replace(/==?$/,""));let r="",t=0,n=0;for(let a=0;a<e.length;a++)t<<=6,t|=f.indexOf(e[a]),n+=6,24===n&&(r+=String.fromCharCode((16711680&t)>>16),r+=String.fromCharCode((65280&t)>>8),r+=String.fromCharCode(255&t),t=n=0);12===n?(t>>=4,r+=String.fromCharCode(t)):18===n&&(t>>=2,r+=String.fromCharCode((65280&t)>>8),r+=String.fromCharCode(255&t));return r}(e),t=new ArrayBuffer(r.length),n=new DataView(t);for(let e=0;e<t.byteLength;e++)n.setUint8(e,r.charCodeAt(e));return t}const f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function l(e,r){return function(e,r){if("number"==typeof e)return a(e,!0);if(!Array.isArray(e)||0===e.length)throw new Error("Invalid input");const t=e,n=Array(t.length);function a(e,o=!1){if(-1===e)return;if(-3===e)return NaN;if(-4===e)return 1/0;if(-5===e)return-1/0;if(-6===e)return-0;if(o||"number"!=typeof e)throw new Error("Invalid input");if(e in n)return n[e];const c=t[e];if(c&&"object"==typeof c)if(Array.isArray(c))if("string"==typeof c[0]){const t=c[0],o=r?.[t];if(o)return n[e]=o(a(c[1]));switch(t){case"Date":n[e]=new Date(c[1]);break;case"Set":const r=new Set;n[e]=r;for(let e=1;e<c.length;e+=1)r.add(a(c[e]));break;case"Map":const o=new Map;n[e]=o;for(let e=1;e<c.length;e+=2)o.set(a(c[e]),a(c[e+1]));break;case"RegExp":n[e]=new RegExp(c[1],c[2]);break;case"Object":n[e]=Object(c[1]);break;case"BigInt":n[e]=BigInt(c[1]);break;case"null":const s=Object.create(null);n[e]=s;for(let e=1;e<c.length;e+=2)s[c[e]]=a(c[e+1]);break;case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":case"BigInt64Array":case"BigUint64Array":{const r=new(0,globalThis[t])(a(c[1]));n[e]=void 0!==c[2]?r.subarray(c[2],c[3]):r;break}case"ArrayBuffer":{const r=i(c[1]);n[e]=r;break}case"Temporal.Duration":case"Temporal.Instant":case"Temporal.PlainDate":case"Temporal.PlainTime":case"Temporal.PlainDateTime":case"Temporal.PlainMonthDay":case"Temporal.PlainYearMonth":case"Temporal.ZonedDateTime":{const r=t.slice(9);n[e]=Temporal[r].from(c[1]);break}case"URL":{const r=new URL(c[1]);n[e]=r;break}case"URLSearchParams":{const r=new URLSearchParams(c[1]);n[e]=r;break}default:throw new Error(`Unknown type ${t}`)}}else{const r=new Array(c.length);n[e]=r;for(let e=0;e<c.length;e+=1){const t=c[e];-2!==t&&(r[e]=a(t))}}else{const r={};n[e]=r;for(const e in c){if("__proto__"===e)throw new Error("Cannot parse an object with a `__proto__` property");const t=c[e];r[e]=a(t)}}else n[e]=c;return n[e]}return a(0)}(JSON.parse(e),r)}function u(n,o){const i=[],f=new Map,l=[];if(o)for(const e of Object.getOwnPropertyNames(o))l.push({key:e,fn:o[e]});const u=[];let g=0;const y=function n(o){if("function"==typeof o)throw new e("Cannot stringify a function",u);if(void 0===o)return-1;if(Number.isNaN(o))return-3;if(o===1/0)return-4;if(o===-1/0)return-5;if(0===o&&1/o<0)return-6;if(f.has(o))return f.get(o);const y=g++;f.set(o,y);for(const{key:e,fn:r}of l){const t=r(o);if(t)return i[y]=`["${e}",${n(t)}]`,y}let h="";if(r(o))h=p(o);else{const i=function(e){return Object.prototype.toString.call(e).slice(8,-1)}(o);switch(i){case"Number":case"String":case"Boolean":h=`["Object",${p(o)}]`;break;case"BigInt":h=`["BigInt",${o}]`;break;case"Date":h=`["Date","${!isNaN(o.getDate())?o.toISOString():""}"]`;break;case"URL":h=`["URL",${a(o.toString())}]`;break;case"URLSearchParams":h=`["URLSearchParams",${a(o.toString())}]`;break;case"RegExp":const{source:f,flags:l}=o;h=l?`["RegExp",${a(f)},"${l}"]`:`["RegExp",${a(f)}]`;break;case"Array":h="[";for(let e=0;e<o.length;e+=1)e>0&&(h+=","),e in o?(u.push(`[${e}]`),h+=n(o[e]),u.pop()):h+=-2;h+="]";break;case"Set":h='["Set"';for(const e of o)h+=`,${n(e)}`;h+="]";break;case"Map":h='["Map"';for(const[e,t]of o)u.push(`.get(${r(e)?p(e):"..."})`),h+=`,${n(e)},${n(t)}`,u.pop();h+="]";break;case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":case"BigInt64Array":case"BigUint64Array":{const e=o;h='["'+i+'",'+n(e.buffer);const r=o.byteOffset,t=r+o.byteLength;if(r>0||t!==e.buffer.byteLength){const e=+/(\d+)/.exec(i)[1]/8;h+=`,${r/e},${t/e}`}h+="]";break}case"ArrayBuffer":h=`["ArrayBuffer","${s(o)}"]`;break;case"Temporal.Duration":case"Temporal.Instant":case"Temporal.PlainDate":case"Temporal.PlainTime":case"Temporal.PlainDateTime":case"Temporal.PlainMonthDay":case"Temporal.PlainYearMonth":case"Temporal.ZonedDateTime":h=`["${i}",${a(o.toString())}]`;break;default:if(!function(e){const r=Object.getPrototypeOf(e);return r===Object.prototype||null===r||null===Object.getPrototypeOf(r)||Object.getOwnPropertyNames(r).sort().join("\0")===t}(o))throw new e("Cannot stringify arbitrary non-POJOs",u);if((b=o,Object.getOwnPropertySymbols(b).filter(e=>Object.getOwnPropertyDescriptor(b,e).enumerable)).length>0)throw new e("Cannot stringify POJOs with symbolic keys",u);if(null===Object.getPrototypeOf(o)){h='["null"';for(const e in o)u.push(c(e)),h+=`,${a(e)},${n(o[e])}`,u.pop();h+="]"}else{h="{";let e=!1;for(const r in o)e&&(h+=","),e=!0,u.push(c(r)),h+=`${a(r)}:${n(o[r])}`,u.pop();h+="}"}}}var b;return i[y]=h,y}(n);return y<0?`${y}`:`[${i.join(",")}]`}function p(e){const r=typeof e;return"string"===r?a(e):e instanceof String?a(e.toString()):void 0===e?(-1).toString():0===e&&1/e<0?(-6).toString():"bigint"===r?`["BigInt","${e}"]`:String(e)}export{l as parse,u as stringify};
